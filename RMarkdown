---
title: "Data Exploration Project"
author: "Brian Thomas"
date: "5/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

##Loading Library
library(tidyverse)
library(purrr)
library(lubridate)
library(fixest)
library(multcomp)
library(vtable)
```
## Intro

The College Scorecard is a public-facing website that contains important information about colleges, including how much its graduates earn. This information has traditionally been very difficult to find. The College Scorecard that was released at the start of September 2015 shows data from colleges that predominantly grant Bachelors degrees. In this exploration project I will be looking at whether or not the release of the College Scorecard has been effective in shifting student interest in high-earning colleges relative to low-earning colleges. 

```{r} 
# Filter college for Bachelor's degree and removing NA values. 
final_data <- read_csv('~finaldata.csv')
final_data %>% 
  drop_na()
final_data[ , colSums(is.na(final_data)) < nrow(final_data)]
clean_df <- final_data %>% 
  filter(preddeg == 3, na.rm=TRUE)
```

# Analysis 

Since our College Scorecard data looks at the colleges predominantly from the end of the 2015 year, I've decided to do some searching and according to the U.S bureau of labor statistics, at the start of the year 2016, the median income of workers with a Bachelors degree in the U.S. was $1,155. Which in turn gives us a Median Annual Salary of $60,060. This will become the split value between the high-earning and low-earning college groups.

Creating dummy variables with ifelse() function to set the benchmark, where '1' is high-earning and '0' is low-earning. 
```{r} 
bachelors_degree_trend$medianEarning <- ifelse(bachelors_degree_trend$`md_earn_wne_p10-reported-earnings` >= 64896, '1', '0') 
```

Selecting only the necessary columns that we want to use in our data set. 
```{r}
bachelors_degree_trend <- bachelors_degree_trend %>% 
                          dplyr::select(unitid, opeid.x, instnm, city, monthorweek, preddeg, sat_avg, ugds, `md_earn_wne_p10-reported-earnings`, medianEarning, index_id) %>%
                          mutate(date= as.Date(str_sub(monthorweek, 1,10))) %>%
                          group_by(month = floor_date(date, "month"), medianEarning) %>%
                          summarize(index_id = mean(index_id, na.rm = TRUE))
```

# Regression

According to the US department of education, the college scorecard was launched on September 12,2015. The regression below is going to test whether there is an impact on Google Trends index on median earnings, before and after the college scorecard was launched.

```{r} 
clean_data <- clean_data %>%
  mutate(earning = `md_earn_wne_p10-reported-earnings` >= 64896, post_scorecard = monthorweek >= 
           as.Date("2015-09-12"))
m1 <- feols(index_id ~ earning*post_scorecard, data=clean_data) 
export_summs(m1, digits = 3)
```

### Interpretation of Regression: 
From the regression above, we can determine that there is an 1.9 percent change in the effect of high-earning colleges in the trends after the scorecard was released. 

# Visualization
The visualization below will show the impacts of Google Trends index within the years of high-earning and low-earning colleges. Here, high-earning is depicted as '1', while low-earning is depicted as '0'.

```{r, echo=FALSE}
ggplot(bachelors_degree_trend, aes(x=month, y=index_id, color=medianEarning)) + 
  geom_line(aes(color= medianEarning), size=0.8) +
  geom_vline(xintercept = as.Date("2015-09-12")) + theme_bw() + guides(color=guide_legend("Median Earning"))+
  labs(title= "The Impact of Google Trends Index Within the Years for Colleges")
```

### Interpretation for Visualization: 
From the line graph, we can conclude that there is not much difference between the low-earning and high-earning. We can see that both lines follow a similar pattern where it decreases over time, overall. In the date that the college scorecard was launched, which is 12 September 2015, we can see that both high-earning and low-earning colleges had an increase in a short period of time before decreasing over the next year. This suggest that median earnings for colleges is not significantly impacted by the Google trends index.
